Include: MockMiddleTalker.vader

Execute (ThreadBuffer: Construct, Initialize; Test Subscription):
  let g:tb = dapper#ThreadBuffer#new('[dapper] Threads', g:mock_mt)
Then:
  AssertEqual function(g:tb.receive), g:last_sub[1]
  AssertNotEqual -1, match(g:last_sub[0], 'Thread')

Execute (ThreadBuffer: Receive ThreadEvent, started):
  let g:msg = dapper#dap#Event#new(0, 'ThreadEvent')
  let g:msg['event'] = 'ThreadEvent'
  let g:msg['typename'] = 'ThreadEvent'
  let g:msg['body'] = {'threadId': 123, 'reason': 'started'}
  call g:tb.receive(g:msg)
  call g:tb.open()
Expect:
  thread	id: 123	name: unnamed	status: started
  
Then (Check for ThreadsRequest):
  let g:req = g:last_req[0]
  let g:Cb  = g:last_req[1]
  AssertEqual 'request', g:req['type']
  AssertEqual 'threads', g:req['command']
